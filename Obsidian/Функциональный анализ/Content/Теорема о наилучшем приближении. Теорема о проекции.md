Теорема о наилучшем приближении. Теорема о проекции
---------------------------------------------------

Два элемента $x,y$ в гильбертовом пространстве $H$ называются *ортогональными* (обозначение $x\perp y$), если $\left\langle x, y\right\rangle =0$. Если $L\subset H$, то запись $x\perp L$ означает, что $x\perp y$ для всех $y\in L$. Наконец, $L^\perp=\left\lbrace x\in H : x\perp L \right\rbrace$.

Если $L\subset H$ --- произвольное подмножество, то $L^\perp$ --- замкнутое линейное подпространство в $H$.

Пусть $x,y\in L^\perp$, $\alpha, \beta\in\Lambda$ и $z\in L$. Так как $$\left\langle \alpha x +\beta y, z\right\rangle  = \alpha\left\langle x, z\right\rangle +\beta\left\langle y, z\right\rangle =0,$$ то $\alpha x +\beta y \in L^\perp$. Таким образом $L^\perp$ --- линейное подпространство.

Осталось показать, что $L^\perp$ замкнуто в $H$. Пусть $x_0$ --- предельная для $L^\perp$. Рассмотрим последовательность $\{x_n\}_{n=1}^\infty\subset L^\perp$, сходящуюся к $x_0$. По $\left\langle x_n, l\right\rangle \to\left\langle x_0, l\right\rangle$ для каждого $l\in L$, откуда $\left\langle x_0, l\right\rangle  = 0$ для всех $l\in L$, то есть $x_0\in L^\perp$.

Пусть $H$ --- гильбертово пространство, $x,y\in H$ и $x\perp y$. Тогда $\lVert x+y \rVert^2 = \lVert x \rVert^2 + \lVert y \rVert^2$.

$\lVert x+y \rVert^2 = \left\langle x+y, x+y\right\rangle  = \lVert x \rVert^2 + \lVert y \rVert^2 + \left\langle x, y\right\rangle  + \left\langle y, x\right\rangle = \lVert x \rVert^2 + \lVert y \rVert^2$.

Пусть $x_1,\ldots,x_k$ --- попарно ортогональные элементы в гильбертовом пространстве. Тогда $\lVert x_1+\ldots+x_k \rVert^2 = \lVert x_1 \rVert^2 +\ldots + \lVert x_k \rVert^2$.

Пусть $H$ --- гильбертово пространство, $L\subset H$ --- замкнутое линейное подпространство и $x\notin L$. Тогда в $L$ существует единственный $y$, ближайший к $x$, то есть такой, что $\lVert x-y \rVert=\inf_{l\in L}\lVert x-l \rVert$, причём $(x-y)\perp L$.

Обозначим $d=\inf_{l\in L}\lVert x-l \rVert$. По определению инфимума для каждого $n\in\mathbb{N}$ найдётся такой элемент $l_n\in L$, что $$d^2\leqslant\lVert x-l_n \rVert^2<d^2 + 1/n \tag{$\ast$}.$$

Докажем, что последовательность $\{l_n\}_{n=1}^\infty$ фундаментальна. Составим равенство параллелограмма для $x-l_n$ и $x-l_m$:
$$\lVert (x-l_n)+(x-l_m) \rVert^2+\lVert (x-l_n)-(x-l_m) \rVert^2=2\lVert x-l_n \rVert^2+2\lVert x-l_m \rVert^2.$$ $$\begin{gathered} \lVert l_m-l_n \rVert^2 = 2\lVert x-l_n \rVert^2+2\lVert x-l_m \rVert^2 - 4\left\lVert x-\dfrac{l_n+l_m}{2} \right\rVert^2< \\ < 2(d^2+1/n)+2(d^2+1/m)-4d^2=2/n+2/m.\end{gathered}$$

Итак, последовательность $\{l_n\}_{n=1}^\infty$ фундаментальна. Пусть $\lim_{n\to\infty}l_n  = y$. В неравенстве ($\ast$) перейдем к пределу при $n\to \infty$ и получим, что $\lVert x-y \rVert= d = \inf_{l\in L}\lVert x-l \rVert$.

Докажем, что $(x-y)\perp L$. Пусть $l\in L$. Так как $y+\lambda l\in L$ при любом $\lambda\in\Lambda$, то $$\begin{gathered} d^2\leqslant\lVert x-y-\lambda l \rVert^2=\left\langle x-y-\lambda l, x-y-\lambda l\right\rangle =\\
=\left\langle x-y, x-y\right\rangle  - \left\langle x-y, \lambda l\right\rangle  - \left\langle \lambda l, x-y\right\rangle  + \left\langle \lambda l, \lambda l\right\rangle  =\\
=\lVert x-y \rVert^2 - \overline{\lambda}\left\langle x-y, l\right\rangle  - \lambda\left\langle l, x-y\right\rangle  + \lambda\overline{\lambda}\left\langle l, l\right\rangle  =\\
=d^2 - \overline{\lambda}\left\langle x-y, l\right\rangle  - \lambda\left\langle l, x-y\right\rangle  + \lambda\overline{\lambda}\left\langle l, l\right\rangle ,\end{gathered}$$
откуда
$$\overline{\lambda}\left\langle x-y, l\right\rangle  + \lambda\left\langle l, x-y\right\rangle  - \lambda\overline{\lambda}\left\langle l, l\right\rangle \leqslant 0.$$
Положим в последнем неравенстве $\lambda=\frac{\left\langle x-y, l\right\rangle }{\lVert l \rVert^2}$. Тогда $$\frac{\overline{\left\langle x-y, l\right\rangle }\cdot \left\langle x-y, l\right\rangle }{\lVert l \rVert^2} +
\frac{\left\langle x-y, l\right\rangle \cdot \overline{\left\langle x-y, l\right\rangle }}{\lVert l \rVert^2} \leqslant
\frac{\left\langle x-y, l\right\rangle \cdot \overline{\left\langle x-y, l\right\rangle }}{\lVert l \rVert^2}.$$
Из этого неравенства следует равенство $\lvert \left\langle x-y, l\right\rangle  \rvert^2 = 0$, которое (в силу произвольности $l\in L$) влечет, что $(x-y)\perp L$.

Единственность. Предположим, что $y,y_1\in L$ --- ближайшие к $x$. Тогда по доказанному $x-y \in L^\perp$ и $x-y_1 \in L^\perp$. Так как $L^\perp$ --- линейное подпространство, то и $(x-y)-(x-y_1)=y_1-y \in L^\perp$. Кроме того, $y_1-y \in L$. Тогда $\left\langle y_1-y, y_1-y\right\rangle =0$, откуда получаем, что $y=y_1$.

Пусть $H$ --- гильбертово и $L\subset H$ --- замкнутое линейное подпространство. Тогда для каждого $x\in H$ найдутся единственный $y\in L$ и единственный $z\in L^\perp$ такие, что $x=y+z$.

Пусть $y\in L$ --- ближайший к $x$. Запишем $x$ в виде $x=y+(x-y)$. По $z=x-y\in L^\perp$.  
Докажем единственность: пусть $x=y+z=y_1+z_1$. Тогда $y-y_1=z_1-z$. Кроме того, $\left\langle y-y_1, z_1-z\right\rangle =0$. Значит, $y-y_1=z_1-z = 0$.

Пусть $H$ --- гильбертово пространство и $L\subset H$. Тогда следующие условия эквивалентны:

1)  $L=L^{\perp\perp}$;

2)  $L$ --- замкнутое подпространство.

$(1)\Rightarrow (2)$ --- очевидно.

$(2)\Rightarrow (1)$. Включение $L\subset L^{\perp\perp}$ очевидно.

Пусть теперь $l\in L^{\perp\perp}$. Тогда по теореме о проекции $l$ единственным образом представляется в виде $y+z$, где $y\in L$, а $z\in L^\perp$. Из равенства $$0=\left\langle l, z\right\rangle =\left\langle y+z, z\right\rangle =\left\langle y, z\right\rangle +\left\langle z, z\right\rangle =\left\langle z, z\right\rangle$$ следует, что $z=0$, откуда $l=y\in L$.

Пусть $H$ --- гильбертово пространство, $L\subset H$ --- замкнутое подпространство и $x\in H$. Если $x$ представлен в виде $x=y+z$ где $y\in L$, а $z\in L^\perp$, то $y$ --- ближайший к $x$ из $L$, а $z$ ---  ближайший к $x$ из $L^\perp$.

Для доказательства следствия достаточно показать, что $z$ --- ближайший к $x$ из $L^\perp$. Применим теорему о проекции к подпространству $L^\perp$: согласно ей, $x$ единственным образом представляется в виде $x=v+w$, где $v\in L^\perp$ и $w\in L^{\perp\perp}$, причём $v$ --- ближайший к $x$ в подпространстве $L^\perp$. Но по предыдущему следствию $w\in L$. Значит, в силу единственности разложения $w=y$ и $v=z$.

Пусть $H$ --- гильбертово пространство и $L\subset H$ --- подпространство. Тогда $\overline{L}\ne H$ если и только если найдётся такой отличный от нуля $z\in H$, что $z\perp L$.

($\Leftarrow$) Так как $z\perp L$, то из непрерывности скалярного произведения следует, что $z\perp \overline{L}$. Таким образом, $z\notin\overline{L}$.

($\Rightarrow$) Так как $\overline{L}\ne H$, то существует $x\in H\setminus\overline{L}$. По $x=y+z$, где $y\in\overline{L}$ и $z\in\overline{L}^\perp$, причём $z\ne 0$.

Рассмотрим пространство $\ell_\infty$ и в нем замкнутое подпространство $L=\left\lbrace (t,0,0,\ldots) : t\in\mathbb{R} \right\rbrace$. Пусть $a=(0,1,0,0,\ldots)$. Тогда $$\rho(a,L)=\inf_{x\in L}\lVert a-x \rVert=\inf_{t\in\mathbb{R}}\lVert (-t,1,0,0,\ldots) \rVert=1.$$

Пусть теперь $x=(t,0,0,\ldots)\in L$ такая, что $\lvert t \rvert\leqslant 1$. Тогда $\lVert a-x \rVert=\lVert (-t,1,0,0,\ldots) \rVert=1$. Таким образом, любая такая точка $x$ --- ближайшая к $a$.
